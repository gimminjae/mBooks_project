<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container py-3 px-5 mx-auto">
    <h1 class="text-center text-5xl mb-2">글 수정 페이지</h1>
    <div class="hero">
        <form th:action="@{|/post/${post.id}/modify|}" method="post">
            <div class="ml-5">
                <p class="text-5xl font-bold mb-2">글 제목</p>
                <input class="input input-bordered" type="text" name="subject" id="subject" th:field="*{post.subject}">
                <p id="size" class="text-3xl" style="float: right;"></p>
            </div>
            <div class="ml-5">
                <p class="text-3xl mb-2">해시태그</p>
                <input class="input input-bordered" style="width: 45%;"
                       type="text" name="hashtag" id="hashtag" th:value="${tags}">
            </div>
            <div class="hero-content flex-col lg:flex-row">
                <link rel="stylesheet"
                      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/codemirror.min.css"/>
                <link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css"/>
                <div id="editor" th:value="*{post.content}"></div>
                <!-- !!여기!! 에디터 내용을 받을 div태그-->
                <input type="hidden" id="content" name="content" th:field="*{post.content}" />
            </div>
            <!-- TOAST UI Editor CDN URL(JS) -->
            <script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>

            <!-- TOAST UI Editor 생성 JavaScript 코드 -->
            <script th:inline="javascript">
                const fieldContent = [[${post.content}]];
                const editor = new toastui.Editor({
                    el: document.querySelector('#editor'),
                    previewStyle: 'vertical',
                    height: '500px',
                    initialValue: fieldContent
                });

                function Post_submit(form) {
                    form.subject.value = form.subject.value.trim();
                    if (form.subject.value.length == 0) {
                        warningModal("제목을 입력해주세요.");
                        form.subject.focus();

                        return;
                    }

                    const markdown = editor.getMarkdown();
                    console.log(markdown);
                    form.content.value = markdown.trim();
                    if (form.content.value.length == 0) {
                        warningModal("내용을 입력해주세요.");
                        editor.focus();
                        return;
                    }

                    form.submit();
                }


            </script>
            <!--                <div>-->
            <!--                    <textarea class="textarea textarea-bordered" name="content" id="content" cols="75" rows="18" th:field="*{post.content}"-->
            <!--                              onkeyup='printName()'></textarea>-->
            <!--                </div>-->
            <!--                <div>-->
            <!--                    <textarea id="result" class="textarea textarea-bordered" disabled cols="75" rows="18"></textarea>-->
            <!--                </div>-->
    </div>
    <!--            <script>-->
    <!--                function printName() {-->
    <!--                    const name = document.getElementById('content').value;-->
    <!--                    document.getElementById("result").innerText = name;-->

    <!--                    let length = name.length;-->
    <!--                    document.getElementById("size").innerText = length;-->
    <!--                }-->
    <!--            </script>-->
    <button class="btn btn-primary" style="float: right;">저장</button>
    </form>
</div>


</div>
</html>